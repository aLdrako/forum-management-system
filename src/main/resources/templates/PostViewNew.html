<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <title th:text="#{page.title.post-view}">Forum Management System</title>
    <th:block th:replace="~{fragments/head :: head}"></th:block>
    <link href="../static/styles/style.css" th:href="@{/styles/style.css}" rel="stylesheet">
</head>

<body class="user-view d-flex flex-column min-vh-100">
<header th:replace="~{fragments/navbar :: header(context='post-details')}"></header>
<div class="container mt-5">
    <article class="blog-post">
        <h2 class="blog-post-title" th:text="${post.getTitle()}">Sample post title</h2>
        <p class="blog-post-meta">
            <span th:text="${post.getDatecreated()} + ' by '">Date Created</span>
            <span><a href="#" th:href="@{/users/{id}(id=${post.getUserCreated().getId()})}"
                     th:text="${post.getUserCreated().getUsername()}">&nbsp&nbsp</a></span>
            <span>
                <a class="btn btn-warning text-dark btn-sm" href="#"
                   th:href="@{${requestURI} + '/update'}" th:if="${session.user == post.getUserCreated() || session.isAdmin}"
                   th:text="#{post-form.update}">Update Post</a></span>
            <span>
                <a data-bs-toggle="modal" data-bs-target="#deleteModal" class="btn btn-danger text-light btn-sm" href="#">Delete Post</a></span>
        </p>
        <p th:text="${post.getContent()}">This blog post shows a few different types of content.</p>
        <section>
            <a class="btn" th:classappend="${session.isAuthenticated && post.getLikes().contains(session.user)} ? 'btn-danger bi bi-heart' : 'btn-light bi bi-heart'"
               th:href="@{/posts/{id}/like(id=${post.getId()})}">
            </a>
            <a class="btn" th:classappend="${session.isAuthenticated} ? 'btn-primary bi bi-reply-fill'"
               th:href="@{/posts/{id}/reply(id=${post.getId()})}">
            </a>
        </section>
        <hr>
    </article>

    <form th:replace="~{/fragments/comment-form :: comment-form-sort}"></form>
    <div class="list-group w-auto mt-1">
        <th:block th:if="${comments.isEmpty()}">
            <div class="d-flex gap-2 w-100 justify-content-center">
                <div>
                    <h6 class="mb-0 display-6">No Comments</h6>
                </div>
            </div>
        </th:block>
        <th:block th:each="comment : ${comments}">
            <a href="#" th:href="@{/comments/{id}(id=${comment.id})}" class="list-group-item list-group-item-action d-flex gap-3 py-3" aria-current="true">
                <i class="bi bi-chat-left-text" style="font-size: 2rem; color: cornflowerblue;"></i>
                <div class="d-flex gap-2 w-100 justify-content-between">
                    <div class="flex-grow-1">
                        <p class="mb-0 opacity-75" th:text="${comment.content}">Body (design!)</p>
                    </div>
                    <small class="d-sm-none d-md-inline" th:text="${comment.createdBy.username}">Created By (design!)</small>
                    <small class="opacity-50 text-nowrap" th:text="${comment.dateCreated}">Date Created (design!)</small>

                </div>
            </a>
        </th:block>
    </div>

<!--    <div class="row justify-content-center mt-2">-->
<!--        <div class="col-lg-10">-->
<!--            <ul class="nav nav-tabs justify-content-center" id="myTab" role="tablist">-->
<!--                <li class="nav-item" role="presentation">-->
<!--                    <button class="nav-link active" id="posts-tab" data-bs-toggle="tab" data-bs-target="#posts-tab-pane" type="button" role="tab" aria-controls="posts-tab-pane" aria-selected="true">Likes</button>-->
<!--                </li>-->
<!--                <li class="nav-item" role="presentation">-->
<!--                    <button class="nav-link" id="comments-tab" data-bs-toggle="tab" data-bs-target="#comments-tab-pane" type="button" role="tab" aria-controls="comments-tab-pane" aria-selected="false">Comments</button>-->
<!--                </li>-->
<!--            </ul>-->
<!--            <div class="tab-content" id="myTabContent">-->
<!--                <div class="tab-pane fade show active" id="posts-tab-pane" role="tabpanel" aria-labelledby="posts-tab" tabindex="0">-->
<!--                    <table class="table table-bordered table-striped table-hover mt-5">-->
<!--                        <thead>-->
<!--                        <tr>-->
<!--                            <th scope="col" class="text-center">ID</th>-->
<!--                            <th scope="col" class="col-8">Username</th>-->
<!--                            <th scope="col" class="d-sm-none d-md-table-cell">Date Joined</th>-->
<!--                        </tr>-->
<!--                        </thead>-->
<!--                        <tbody>-->
<!--                        <tr th:if="${post.getLikes().isEmpty()}">-->
<!--                            <td colspan="7" class="text-center">No Posts</td>-->
<!--                        </tr>-->
<!--                        <tr th:each="user : ${post.getLikes()}">-->
<!--                            <th scope="row" class="text-center align-middle"><a href="#" th:href="@{/users/{id}(id=${user.id})}"><i class="bi bi-person-vcard" style="font-size: 2rem;"></i></a></th>-->
<!--                            <td class="align-middle" th:text="${user.username}">Some text (design!)</td>-->
<!--                            <td class="d-sm-none d-md-table-cell align-middle" th:text="${user.getJoiningDate()}">Created (design!)</td>-->
<!--                        </tr>-->
<!--                        </tbody>-->
<!--                    </table>-->
<!--                </div>-->
<!--                <div class="tab-pane fade" id="comments-tab-pane" role="tabpanel" aria-labelledby="comments-tab" tabindex="0">-->
<!--                    <table class="table table-bordered table-striped table-hover mt-5">-->
<!--                        <thead>-->
<!--                        <tr>-->
<!--                            <th scope="col" class="text-center">ID</th>-->
<!--                            <th scope="col" class="col-8">Content</th>-->
<!--                            <th scope="col" class="d-sm-none d-md-table-cell">Date Created</th>-->
<!--                        </tr>-->
<!--                        </thead>-->
<!--                        <tbody>-->
<!--                        <tr th:if="${post.getComments().isEmpty()}">-->
<!--                            <td colspan="7" class="text-center">No Comments</td>-->
<!--                        </tr>-->
<!--                        <tr th:each="comment : ${post.getComments()}">-->
<!--                            <th scope="row" class="text-center align-middle"><a href="#" th:href="@{/comments/{id}(id=${comment.id})}"><i class="bi bi-chat-left-text" style="font-size: 2rem;"></i></a></th>-->
<!--                            <td class="align-middle" th:text="${comment.content}">Some text (design!)</td>-->
<!--                            <td class="d-sm-none d-md-table-cell align-middle" th:text="${comment.dateCreated}">Created (design!)</td>-->
<!--                        </tr>-->
<!--                        </tbody>-->
<!--                    </table>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

</div>

<!-- Delete Modal -->
<div class="modal fade" id="deleteModal" tabindex="-1" data-bs-backdrop="static" data-bs-keyboard="false" aria-labelledby="deleteModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="deleteModalLabel">Confirm Delete</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                Are you sure you want to delete post?
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <a href="#" th:href="@{${requestURI} + '/delete'}" class="btn btn-danger">Delete</a>
            </div>
        </div>
    </div>
</div>

<div th:replace="~{fragments/footer :: footer}"></div>
<script th:replace="~{fragments/scripts :: bootstrap}"></script>
</body>
</html>